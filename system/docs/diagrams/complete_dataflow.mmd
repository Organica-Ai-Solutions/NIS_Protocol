graph TD
    subgraph "ðŸŒ External Interfaces"
        A[ðŸ‘¤ User via API/Chat]
        A1[ðŸ”Œ Third-Party Protocols]
        A2[ðŸŒ Web Search APIs]
    end

    subgraph "âš¡ Web Server (FastAPI + Nginx)"
        B[ðŸ›¡ï¸ API Endpoints]
        B1[ðŸ“Š /metrics]
        B2[ðŸ’¬ /chat/stream]
        B3[ðŸ§  /agents/*]
        B4[ðŸ§ª /simulation/*]
        C[ðŸ”„ Request/Response Handler]
    end

    subgraph "ðŸŽ¯ Unified Coordination Layer"
        D[ðŸŽª UnifiedCoordinator]
        D1[ðŸ§ª Scientific Pipeline]
        D2[ðŸ¤– Agent Management]
        D3[ðŸ—ï¸ Infrastructure Control]
        D4[ðŸ§  Meta Protocol Bridge]
    end

    subgraph "ðŸ§  Core Intelligence"
        E[ðŸŽ›ï¸ LLM Manager]
        E1[ðŸ¤– OpenAI Provider]
        E2[ðŸŽ­ Anthropic Provider]
        E3[ðŸš€ DeepSeek Provider]
        E4[âš¡ BitNet Provider]
        E5[ðŸŽª Cognitive Orchestra]
        F[ðŸ—‚ï¸ Agent Router]
        G[ðŸ§  Memory Manager]
        H[ðŸ”— Symbolic Bridge]
    end

    subgraph "ðŸ§ª Mathematical Pipeline (Laplaceâ†’KANâ†’PINN)"
        I[ðŸ“¡ Unified Signal Agent]
        I1[ðŸ“Š Laplace Transform]
        I2[ðŸ” Signal Processing]
        J[ðŸ§® Unified Reasoning Agent]
        J1[ðŸ•¸ï¸ KAN Networks]
        J2[ðŸ§  Symbolic Reasoning]
        K[âš—ï¸ Unified Physics Agent]
        K1[ðŸ“ PINN Validation]
        K2[ðŸ”¬ Physics Laws]
    end

    subgraph "ðŸ—ï¸ Infrastructure Layer"
        L[ðŸ“¨ Kafka Streaming]
        M[ðŸ’¾ Redis Cache]
        N[ðŸ—„ï¸ PostgreSQL]
        O[ðŸ“Š Monitoring]
    end

    subgraph "ðŸ¤– Specialized Agents"
        P[ðŸ˜Š Emotion Agent]
        Q[ðŸŽ¯ Goals Agent] 
        R[ðŸ§ª Curiosity Agent]
        S[âš–ï¸ Ethics Agent]
        T[ðŸ’­ Memory Agent]
        U[ðŸ‘ï¸ Vision Agent]
        V[ðŸ”§ Engineering Agents]
    end

    %% Main Flow
    A --> B
    A1 --> B
    A2 --> B
    B --> C
    C --> D
    
    %% Coordination Flow
    D --> E
    D --> F
    D --> G
    D --> H
    
    %% Mathematical Pipeline Flow
    D --> I
    I --> J
    J --> K
    
    %% Signal Processing Details
    I1 -.-> I2
    I2 --> J1
    J1 -.-> J2
    J2 --> K1
    K1 -.-> K2
    
    %% LLM Provider Management
    E --> E1
    E --> E2
    E --> E3
    E --> E4
    E5 --> E1
    E5 --> E2
    E5 --> E3
    
    %% Agent Routing
    F --> P
    F --> Q
    F --> R
    F --> S
    F --> T
    F --> U
    F --> V
    
    %% Infrastructure Connections
    D --> L
    G --> M
    G --> N
    D --> O
    
    %% Feedback Loops
    K --> D
    P --> F
    Q --> F
    R --> F
    S --> F
    T --> G
    U --> F
    V --> F
    
    %% Response Flow
    D --> C
    C --> B
    B --> A

    %% Styling
    classDef coordinator fill:#ff9999,stroke:#333,stroke-width:3px
    classDef mathPipeline fill:#99ccff,stroke:#333,stroke-width:2px
    classDef infrastructure fill:#99ff99,stroke:#333,stroke-width:2px
    classDef agents fill:#ffcc99,stroke:#333,stroke-width:2px
    classDef llm fill:#cc99ff,stroke:#333,stroke-width:2px
    
    class D,D1,D2,D3,D4 coordinator
    class I,I1,I2,J,J1,J2,K,K1,K2 mathPipeline
    class L,M,N,O infrastructure
    class P,Q,R,S,T,U,V agents
    class E,E1,E2,E3,E4,E5 llm